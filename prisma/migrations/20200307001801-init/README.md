# Migration `20200307001801-init`

This migration has been generated by weizhongtan at 3/7/2020, 12:18:01 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."accounts" (
    "created_at" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "initial_amount" Decimal(65,30)  NOT NULL DEFAULT 0,
    "legacy_key" text  NOT NULL DEFAULT '',
    "minimum" Decimal(65,30)  NOT NULL DEFAULT 0,
    "name" text  NOT NULL DEFAULT '',
    "updated_at" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."categories" (
    "created_at" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "id" text  NOT NULL ,
    "legacy_key" text  NOT NULL DEFAULT '',
    "name" text  NOT NULL DEFAULT '',
    "parent_category_id" text   ,
    "type" text   ,
    "updated_at" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."transactions" (
    "amount" Decimal(65,30)  NOT NULL DEFAULT 0,
    "category_id" text   ,
    "created_at" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "date" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    "description" text  NOT NULL DEFAULT '',
    "from_account_id" text   ,
    "id" text  NOT NULL ,
    "pair_id" text   ,
    "paired_with_id" text   ,
    "to_account_id" text   ,
    "updated_at" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00',
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."categories" ADD FOREIGN KEY ("parent_category_id")REFERENCES "public"."categories"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."transactions" ADD FOREIGN KEY ("from_account_id")REFERENCES "public"."accounts"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."transactions" ADD FOREIGN KEY ("to_account_id")REFERENCES "public"."accounts"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."transactions" ADD FOREIGN KEY ("category_id")REFERENCES "public"."categories"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."transactions" ADD FOREIGN KEY ("paired_with_id")REFERENCES "public"."transactions"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200307001801-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,63 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url      = env("DATABASE_URL")
+}
+
+/// The underlying table does not contain a unique identifier and can therefore currently not be handled.
+// model categories_group_by {
+// name String?
+// sum  Float?
+/// The underlying table does not contain a unique identifier and can therefore currently not be handled.
+
+// @@map("__categories_group_by")
+// }
+
+// model transactions_group_by {
+// date DateTime?
+// sum  Float?
+model accounts {
+  // @@map("__transactions_group_by")
+  // }
+
+
+  created_at                                          DateTime
+  id                                                  String         @id
+  initial_amount                                      Float
+  legacy_key                                          String
+  minimum                                             Float
+  name                                                String
+  updated_at                                          DateTime
+  transactions_accountsTotransactions_from_account_id transactions[] @relation("accountsTotransactions_from_account_id")
+  transactions_accountsTotransactions_to_account_id   transactions[] @relation("accountsTotransactions_to_account_id")
+}
+
+model categories {
+  created_at         DateTime
+  id                 String         @id
+  legacy_key         String
+  name               String
+  type               String?
+  updated_at         DateTime
+  parent_category_id categories?    @relation("categoriesTocategories_parent_category_id")
+  categories         categories[]   @relation("categoriesTocategories_parent_category_id")
+  transactions       transactions[]
+}
+
+model transactions {
+  amount          Float
+  created_at      DateTime
+  date            DateTime
+  description     String
+  id              String         @id
+  pair_id         String?
+  updated_at      DateTime
+  category_id     categories?
+  from_account_id accounts?      @relation("accountsTotransactions_from_account_id")
+  paired_with_id  transactions?  @relation("transactionsTotransactions_paired_with_id")
+  to_account_id   accounts?      @relation("accountsTotransactions_to_account_id")
+  transactions    transactions[] @relation("transactionsTotransactions_paired_with_id")
+}
```


